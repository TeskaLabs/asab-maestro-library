define:
  type: rc/descriptor
  name: ASAB Iris

descriptor:

  image: docker.teskalabs.com/asab/asab-iris

  volumes:
    # For a persistency of the configuration
    - "{{SITE}}/{{INSTANCE_ID}}/conf:/conf:ro"

asab:
  configname: conf/asab-iris.conf
  config: &config {}
    # [smtp] must be filled from general confguration (user)
    # [slack] must be filled from general confguration (user)
    # [kafka] will be filled by the remote-control if kafka exists - what about the name of the topic and group_id?
    # [variables] must be filled from general confguration (user)

asab-config:
  asab-iris:
    __schema__:
      file:
        {
          "title": "asab-iris",
          "type": "object",
          "properties": {
            "slack": {
              "title": "Slack",
              "description": "Configure connection to Slack channel.",
              "type": "object",
              "properties": {
                "token": {
                  "type": "string",
                  "title": "Token"
                  },
                "channel": {
                  "type": "string",
                  "title": "Channel"
                  }
              },
              "required": ["token", "channel"]
            },
            "msteams": {
              "title": "MS Teams",
              "description": "Configure connection to MS Teams.",
              "type": "object",
              "properties": {
                "webhook_url": {
                  "title": "Webhook URL",
                  "type": "string",
                  "format": "uri"
                  }
              },
              "required": ["webhook_url"]
            }
          }
        }
      if_not_exists: true
    config: 
      file:
        *config
      if_not_exists: true


nginx:
  api: 8896
