define:
  type: rc/descriptor
  name: ASAB Iris

descriptor:

  image: docker.teskalabs.com/asab/asab-iris

  volumes:
    # For a persistency of the configuration
    - "{{SITE}}/{{INSTANCE_ID}}/conf:/conf:ro"

asab:
  configname: conf/asab-iris.conf
  config: &config {}  # specify default configuration of the service
    # [smtp] must be filled from general confguration (user)
    # [slack] must be filled from general confguration (user)
    # [variables] must be filled from general confguration (user)

asab-config:
  asab-iris:
    __schema__:
      file:
        {
          "title": "asab-iris",
          "type": "object",
          "properties": {
            "slack": {
              "title": "Slack",
              "description": "Configure connection to Slack channel.",
              "type": "object",
              "properties": {
                "token": {
                  "type": "string",
                  "title": "Token"
                  },
                "channel": {
                  "type": "string",
                  "title": "Channel"
                  }
              },
              "required": ["token", "channel"]
            },
            "msteams": {
              "title": "Microsoft Teams",
              "description": "Configure connection to MS Teams.",
              "type": "object",
              "properties": {
                "webhook_url": {
                  "title": "Webhook URL",
                  "type": "string",
                  "format": "uri"
                  }
              },
              "required": ["webhook_url"]
            }
            "kafka": {
              "title": "Kafka",
              "description": "Configure connection to Kafka.",
              "type": "object",
              "properties": {
                "group_id": {
                  "title": "Kafka consumer group id.",
                  "type": "string",
                 },
                "topic": {
                  "title": "Kafka topic",
                  "type": "string",
                 }
              },
              "required": ["topic", "group_id"]
            }
          }
        }
    config: 
      file:
        *config  # transfer the default configuration to ASAB Config if there is no configuration set for the service, yet
      if_not_exists: true


nginx:
  api: 8896
